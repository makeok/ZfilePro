import{u as c}from"./useFileRepeat.09ef18bd.js";import{o as d,a as f,f as m,af as l,ag as _,y as u}from"./index.a81894c3.js";import{_ as g}from"./plugin-vue_export-helper.21dcd24c.js";import{E as v}from"./request.88c6336a.js";import"./common.d1611fb2.js";import"./useCommon.373cb8ed.js";import"./index.9b197a07.js";import"./index.9f034646.js";import"./base.9447ff7a.js";import"./index.9dce3cd8.js";import"./event.807e9a54.js";import"./index.1d04ede7.js";import"./scroll.c1d55f52.js";import"./focus-trap.c21bbfc6.js";import"./validator.4f1297a1.js";import"./use-outside-click.86ba09c6.js";import"./directive.8a34351b.js";import"./checkbox.adc9a1be.js";import"./index.3b295ed4.js";import"./_Uint8Array.25475a91.js";/* empty css              */import"./index.b1a3ab43.js";import"./XCircleIcon.609d2c30.js";const h=t=>(l("data-v-acdcdb0a"),t=t(),_(),t),y={class:"zfile-office-viewer"},w=h(()=>u("div",{id:"office-body"},null,-1)),E=[w],S={__name:"OfficeViewer",props:{fileUrl:String,fileName:String},setup(t){let a=c();const o=t;d(()=>{n(`${a.globalConfig.onlyOfficeUrl}/web-apps/apps/api/documents/api.js`,()=>{const i=o.fileName.lastIndexOf("."),e={document:{fileType:o.fileName.substr(i+1),title:o.fileName,url:o.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{mode:"view",lang:"zh-CN"}};new DocsAPI.DocEditor("office-body",e)})});function n(i,r){let e=document.createElement("script"),s=document.getElementsByTagName("head")[0];e.type="text/javascript",e.charset="UTF-8",e.src=i,e.addEventListener?(e.addEventListener("load",function(){r()},!1),e.addEventListener("error",function(){v.warning("\u8C03\u7528\u5728\u7EBF\u6587\u6863\u670D\u52A1\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u5728\u7EBF\u6587\u6863\u670D\u52A1\u662F\u5426\u6B63\u5E38")},!1)):e.attachEvent&&e.attachEvent("onreadystatechange",function(){var p=window.event.srcElement;p.readyState==="loaded"&&r()}),s.appendChild(e)}return(i,r)=>(f(),m("div",y,E))}};var J=g(S,[["__scopeId","data-v-acdcdb0a"]]);export{J as default};
