import{x as Q}from"./base.9447ff7a.js";/* empty css                *//* empty css               *//* empty css              */import"./tag.be7f307a.js";import{E as X,a as Y}from"./select.06aace55.js";import"./scrollbar.b58c5e8b.js";import{E as ee}from"./popper.34e4046d.js";import{E as te}from"./alert.73507778.js";import"./tooltip.afcd3f9d.js";import{E as oe}from"./switch.0dde4485.js";import{_ as ae}from"./SvgIcon.bb4e9d6f.js";import{r as g,aa as le,ac as se,o as ne,Z as ie,D as re,u as t,a as k,b as U,e as s,y as e,j as o,A as de,ae as z,bu as T,z as i,f as me,O as ce,P as pe,bv as ue,a1 as _e,a3 as fe,bg as be,l as ve,af as ge,ag as he}from"./index.a81894c3.js";import{Z as F,a as xe}from"./ZFormItem.85c758c5.js";import{r as ye,t as ke,i as L,u as Ie}from"./admin-storage.576b99eb.js";import{u as B}from"./common.3ffdf4de.js";import{S as Ve}from"./sortable.esm.d7ef5fdd.js";import{E as Z}from"./request.88c6336a.js";import{E as Re}from"./index.9f034646.js";import Ee from"./readme-editor-dialog.f806a69d.js";import{b as N}from"./route-block.89f12ae7.js";import{_ as we}from"./plugin-vue_export-helper.21dcd24c.js";import{r as Se}from"./CheckBadgeIcon.5c38551d.js";import{r as Ce}from"./FolderIcon.c78a493a.js";import{E as Ue}from"./index.9dce3cd8.js";import{v as Te}from"./directive.8a34351b.js";import"./event.807e9a54.js";import"./scroll.c1d55f52.js";import"./index.3b295ed4.js";import"./_Uint8Array.25475a91.js";import"./debounce.ff28d2f1.js";import"./validator.4f1297a1.js";import"./focus-trap.c21bbfc6.js";import"./index.b1a3ab43.js";import"./index.1d04ede7.js";import"./dialog.8e75b1b4.js";import"./overlay.e553b113.js";import"./refs.7263a917.js";let n=g([]),D=g(!1);function Be(p,u){let h=u.params.storageId;const I=()=>{ye(h).then(m=>{n.value=m.data,n.value.length===0&&x(),V()})},V=()=>{const m=document.querySelector(".z-form-body");Ve.create(m,{draggable:".expression-item",filter:".el-button, .editor-input",onEnd:l=>{if(l.oldIndex===l.newIndex)return;const _=n.value.splice(l.oldIndex-1,1)[0];n.value.splice(l.newIndex-1,0,_)}})},R=()=>{if(!n.value.find(l=>{if(B.isEmpty(l.description)||B.isEmpty(l.expression)||B.isEmpty(l.readmeText))return Z.warning("\u8BF7\u68C0\u67E5\u6570\u636E\u586B\u5199\u662F\u5426\u5B8C\u6574"),!0})){D.value=!0;for(let l=0;l<n.value.length;l++){let _=n.value[l];_.id=l+1}ke(h,n.value).then(()=>{Re.confirm("\u4FDD\u5B58\u6210\u529F, \u662F\u5426\u8FD4\u56DE\u5B58\u50A8\u6E90\u5217\u8868\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"success",callback:l=>{l==="confirm"&&p.push("/admin/storage-list")}})}).finally(()=>{D.value=!1})}},x=()=>{n.value.push({description:"\u8868\u8FBE\u5F0F - "+(n.value.length+1),expression:"",readmeText:"",displayMode:"top",storageId:h})};return{loading:D,loadReadmeData:I,readmeList:n,addReadmeItem:x,deleteReadmeItem:m=>{n.value.splice(m,1)},saveReadmeData:R}}const c=p=>(ge("data-v-25f3b1b2"),p=p(),he(),p),De={class:"flex justify-between"},Me=c(()=>e("span",{class:"mr-4 text-sm text-gray-500"},"\u517C\u5BB9\u4E3A\u8BFB\u53D6 readme.md",-1)),qe=c(()=>e("div",{class:"rules-tips"},"Glob \u8868\u8FBE\u5F0F\u89C4\u5219\uFF1A",-1)),ze=c(()=>e("div",{class:"rules-tips"},[e("b",null,"/"),i(": \u6839\u76EE\u5F55, \u5982 "),e("span",{class:"code select-all"},"/"),i(" \u8868\u793A\u6839\u8DEF\u5F84\u4E0B\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863\u663E\u793A.")],-1)),Fe=c(()=>e("div",{class:"rules-tips"},[e("b",null,"*"),i("\uFF1A\u5355\u7EA7\u8DEF\u5F84\u901A\u914D\u7B26\uFF0C\u5982\u8868\u8FBE\u5F0F "),e("span",{class:"code select-all"},"/*"),i(" \u8868\u793A\u6839\u8DEF\u5F84\u4E0B\u7684\u76F4\u63A5\u5B50\u6587\u4EF6\u5939\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863\u663E\u793A.")],-1)),Le=c(()=>e("div",{class:"rules-tips"},[e("b",null,"**"),i("\uFF1A\u591A\u7EA7\u8DEF\u5F84\u901A\u914D\u7B26\uFF0C\u5982\u8868\u8FBE\u5F0F "),e("span",{class:"code select-all"},"/music/**"),i(" \u8868\u793A /music \u6587\u4EF6\u5939\u53CA\u4EE5\u4E0B\u6240\u6709\u6587\u4EF6\u5939\u90FD\u4F1A\u52A0\u8F7D\u6B64\u6587\u6863.")],-1)),Ne=c(()=>e("div",{class:"rules-tips"},"\u6CE8\uFF1A\u7CFB\u7EDF\u5339\u914D\u5230\u7B2C\u4E00\u4E2A\u7B26\u5408\u7684\u89C4\u5219\u5C31\u4F1A\u53D6\u6587\u6863\u8FDB\u884C\u663E\u793A\uFF0C\u6240\u4EE5\u8BF7\u8C03\u6574\u597D\u89C4\u5219\u987A\u5E8F\uFF0C\u4E0B\u65B9\u89C4\u5219\u53EF\u8FDB\u884C\u62D6\u62FD\u6392\u5E8F\u3002",-1)),Ze={class:"rules-tips-link"},je={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},Ae=c(()=>e("span",null,"\u53C2\u8003\u6587\u7AE0 (Wikipedia)",-1)),Ge={target:"_blank",class:"link",href:"http://www.ruanyifeng.com/blog/2018/09/bash-wildcards.html"},Oe={target:"_blank",class:"link",href:"https://github.com/whinc/blog/issues/18"},$e={class:"sm:flex sm:space-x-2 sm:border-b-0 sm:pb-0 border-b pb-2"},j={__name:"[storageId]",setup(p){let u=le(),h=se(),I=u.params.storageId;const{loading:V,loadReadmeData:R,readmeList:x,addReadmeItem:M,deleteReadmeItem:m,saveReadmeData:l}=Be(h,u);ne(()=>{R(),A()});const _=g(),A=()=>{L(I).then(r=>{r.data.type=r.data.type.key,_.value=r.data})};let f=g(!1);L(u.params.storageId).then(r=>{f.value=r.data.compatibilityReadme||!1});const G=()=>{Ie(u.params.storageId,f.value).then(r=>{Z.success("\u4FDD\u5B58\u6210\u529F")})};let E=g({}),b=g(!1);const O=r=>{b.value=!0,E.value=r};return(r,v)=>{const $=ae,P=ie("router-link"),W=oe,q=ee,H=te,w=Ue,S=X,J=Y,C=Q,K=Te;return re((k(),U(xe,{model:t(x),class:"zfile-admin-readme-form"},{"form-title":s(()=>{var a;return[e("div",De,[e("div",null,[o(P,{to:"/admin/storage-list"},{default:s(()=>[o($,{class:"inline mr-2 cursor-pointer",name:"file-type-back"})]),_:1}),e("span",null,"\u76EE\u5F55\u6587\u6863\uFF08"+de((a=t(_))==null?void 0:a.name)+"\uFF09",1)]),o(q,{placement:"top",content:"\u542F\u7528\u540E\u4E0B\u53D1\u7684\u89C4\u5219\u8BBE\u7F6E\u4F1A\u5931\u6548\uFF0C\u4EC5\u4F1A\u4E3A\u8BFB\u53D6\u76EE\u5F55\u4E0B\u7684 readme.md \u6587\u4EF6\u6765\u6E32\u67D3\u6587\u6863, \u4E14\u56FA\u5B9A\u5728\u5E95\u90E8\u663E\u793A."},{default:s(()=>[e("div",null,[Me,o(W,{onChange:G,"active-text":"\u662F","inline-prompt":"","inactive-text":"\u5426",modelValue:t(f),"onUpdate:modelValue":v[0]||(v[0]=y=>z(f)?f.value=y:f=y)},null,8,["modelValue"])])]),_:1})])]}),"form-sub-title":s(()=>[o(H,{closable:!1,type:"info"},{default:s(()=>[qe,ze,Fe,Le,Ne,e("div",Ze,[e("a",je,[o(t(T),{class:"inline mr-1"}),Ae]),e("a",Ge,[o(t(T),{class:"inline mr-1"}),i("\u53C2\u8003\u6587\u7AE0 (\u962E\u4E00\u5CF0)")]),e("a",Oe,[o(t(T),{class:"inline mr-1"}),i("\u53C2\u8003\u6587\u7AE0 (Github)")])])]),_:1})]),footer:s(()=>[o(C,{type:"primary",size:"default",icon:t(Se),onClick:t(l)},{default:s(()=>[i("\u4FDD\u5B58\u8BBE\u7F6E")]),_:1},8,["icon","onClick"])]),default:s(()=>[(k(!0),me(ce,null,pe(t(x),(a,y)=>(k(),U(F,{required:!0,key:a,class:"expression-item"},{default:s(()=>[e("div",$e,[o(q,{content:"\u6B64\u5904\u53EF\u586B\u5199\u8868\u8FBE\u4E66\u63CF\u8FF0\uFF0C\u7528\u4E8E\u8F85\u52A9\u8BB0\u5FC6\uFF0C\u9632\u6B62\u65F6\u95F4\u8FC7\u957F\u540E\u4E0D\u77E5\u9053\u8868\u8FBE\u5F0F\u542B\u4E49.",placement:"top"},{default:s(()=>[o(w,{"prefix-icon":t(ue),placeholder:"\u8BF7\u8F93\u5165\u8868\u8FBE\u5F0F\u63CF\u8FF0",modelValue:a.description,"onUpdate:modelValue":d=>a.description=d},null,8,["prefix-icon","modelValue","onUpdate:modelValue"])]),_:2},1024),o(w,{"prefix-icon":t(Ce),placeholder:"\u8BF7\u8F93\u5165\u8868\u8FBE\u5F0F",modelValue:a.expression,"onUpdate:modelValue":d=>a.expression=d,modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue","onUpdate:modelValue"]),o(w,{class:"editor-input",onClick:d=>O(a),readonly:"","prefix-icon":t(_e),placeholder:"\u8BF7\u70B9\u51FB\u7F16\u8F91\u6587\u6863",modelValue:a.readmeText,"onUpdate:modelValue":d=>a.readmeText=d},null,8,["onClick","prefix-icon","modelValue","onUpdate:modelValue"]),o(J,{class:"editor-input",modelValue:a.displayMode,"onUpdate:modelValue":d=>a.displayMode=d},{default:s(()=>[o(S,{label:"\u9876\u90E8\u663E\u793A",value:"top"}),o(S,{label:"\u5E95\u90E8\u663E\u793A",value:"bottom"}),o(S,{label:"\u5F39\u7A97\u663E\u793A",value:"dialog"})]),_:2},1032,["modelValue","onUpdate:modelValue"]),o(C,{type:"danger",onClick:d=>t(m)(y),icon:t(fe)},null,8,["onClick","icon"])])]),_:2},1024))),128)),o(F,null,{default:s(()=>[o(C,{type:"primary",size:"default",icon:t(be),onClick:t(M)},{default:s(()=>[i("\u6DFB\u52A0\u66F4\u591A")]),_:1},8,["icon","onClick"])]),_:1}),t(b)?(k(),U(Ee,{key:0,modelValue:t(E).readmeText,"onUpdate:modelValue":v[1]||(v[1]=a=>t(E).readmeText=a),visible:t(b),"onUpdate:visible":v[2]||(v[2]=a=>z(b)?b.value=a:b=a)},null,8,["modelValue","visible"])):ve("",!0)]),_:1},8,["model"])),[[K,t(V)]])}}};typeof N=="function"&&N(j);var Ut=we(j,[["__scopeId","data-v-25f3b1b2"]]);export{Ut as default};
