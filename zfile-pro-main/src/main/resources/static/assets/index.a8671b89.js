var B=(p,b,f)=>new Promise((v,w)=>{var x=s=>{try{c(f.next(s))}catch(g){w(g)}},o=s=>{try{c(f.throw(s))}catch(g){w(g)}},c=s=>s.done?v(s.value):Promise.resolve(s.value).then(x,o);c((f=f.apply(p,b)).next())});import{x as T}from"./base.9447ff7a.js";/* empty css               *//* empty css              */import"./tag.be7f307a.js";import{E as A,a as C}from"./select.06aace55.js";import"./scrollbar.b58c5e8b.js";import"./popper.34e4046d.js";import{E as J}from"./switch.0dde4485.js";import{_ as $}from"./SvgIcon.bb4e9d6f.js";import"./common.d1611fb2.js";import{Z as _,a as j}from"./ZFormItem.85c758c5.js";import{a as D,e as L,b as P}from"./admin-user.9036c1c8.js";import{r as i,ac as G,aa as H,Z as K,a as y,b as S,e as l,y as R,j as a,u as r,z as h,l as Q,f as W,O as X,P as Y,af as ee,ag as re}from"./index.a81894c3.js";import{b as N}from"./route-block.89f12ae7.js";import{_ as te}from"./plugin-vue_export-helper.21dcd24c.js";import{r as oe}from"./CheckBadgeIcon.5c38551d.js";import{E as le}from"./index.9f034646.js";import{E as ae}from"./request.88c6336a.js";import{E as se}from"./index.9dce3cd8.js";import"./event.807e9a54.js";import"./scroll.c1d55f52.js";import"./index.3b295ed4.js";import"./_Uint8Array.25475a91.js";import"./debounce.ff28d2f1.js";import"./validator.4f1297a1.js";import"./focus-trap.c21bbfc6.js";import"./index.b1a3ab43.js";import"./index.1d04ede7.js";const ne=p=>(ee("data-v-a72ebc3a"),p=p(),re(),p),ue={class:"flex justify-items-center"},me=ne(()=>R("span",null,"\u7528\u6237\u4FE1\u606F",-1)),q={__name:"index",setup(p){i();let b=G(),f=H(),v=i();const w=()=>B(this,null,function*(){v.value.validate((d,t)=>{if(d)s.value=!0,D(o.value).then(()=>{le.confirm("\u4FDD\u5B58\u6210\u529F, \u662F\u5426\u8FD4\u56DE\u7528\u6237\u5217\u8868\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"success",callback:V=>{V==="confirm"&&b.push("/admin/view-user")}})}).finally(()=>{s.value=!1});else return ae.warning("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25, \u8BF7\u68C0\u67E5\u8868\u5355\u6570\u636E\u662F\u5426\u586B\u5199\u6B63\u786E"),!1})});let x=()=>{let d=i({id:null,username:"",usernameZh:"",password:"",enabled:!0,role:"\u666E\u901A\u7528\u6237",remark:""}),t=JSON.parse(JSON.stringify(d.value));const V=e=>{P(e).then(n=>{d.value=n.data,t=JSON.parse(JSON.stringify(d.value))})};let I=i(!0),u=i(!1),U=i(["\u666E\u901A\u7528\u6237","\u7CFB\u7EDF\u7BA1\u7406\u5458"]),Z=i(!1),E=f.params.userId;E&&(u.value=!0,V(E));let k=i({username:[{required:!0,validator:(e,n,m)=>{if(n==null||n===""){m(new Error("\u8BF7\u8F93\u5165\u7528\u6237\u540D"));return}if(!/^[\w\-]+$/.test(n)){m(new Error("\u53EA\u5141\u8BB8\u4F7F\u7528\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u6A2A\u6760"));return}if(u.value&&n==t.username){m();return}L({username:n}).then(z=>{z.data?m(new Error("\u8BE5\u7528\u6237\u540D\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\u3002")):m()})}}],password:[{validator:(e,n,m)=>{if(!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[`~!@#$%^&*()_+<>?:"{},.\/\\;'[\]])[A-Za-z\d`~!@#$%^&*()_+<>?:"{},.\/\\;'[\]]{8,}$/.test(n)){m(new Error("\u81F3\u5C118\u4F4D\u4E14\u5FC5\u6709\u6570\u5B57+\u7279\u6B8A\u5B57\u7B26+\u5B57\u6BCD"));return}m()},trigger:"change"}],usernameZh:[{required:!0,message:"\u4E2D\u6587\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],role:[{required:!0,message:"\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A"}]});return{userItem:d,supportRoleType:U,loading:Z,rules:k,isAdminMode:I,isEditMode:u,oldUserItem:t}},{userItem:o,supportRoleType:c,loading:s,rules:g,isAdminMode:F,isEditMode:M,oldUserItem:ie}=x();return(d,t)=>{const V=$,I=K("router-link"),u=se,U=J,Z=A,E=C,k=T;return y(),S(j,{model:r(o),class:"zfile-storage-edit",rules:r(g),ref_key:"userEditForm",ref:v},{"form-title":l(()=>[R("div",ue,[a(I,{to:"/admin/view-user"},{default:l(()=>[a(V,{class:"inline mr-2 cursor-pointer",name:"file-type-back"})]),_:1}),me])]),footer:l(()=>[a(k,{loading:r(s),type:"primary",size:"default",icon:r(oe),onClick:w},{default:l(()=>[h("\u4FDD\u5B58")]),_:1},8,["loading","icon"])]),default:l(()=>[a(_,{label:"\u7528\u6237\u540D",prop:"username"},{default:l(()=>[a(u,{modelValue:r(o).username,"onUpdate:modelValue":t[0]||(t[0]=e=>r(o).username=e)},null,8,["modelValue"])]),_:1}),a(_,{label:"\u7528\u6237\u4E2D\u6587\u540D",prop:"usernameZh"},{default:l(()=>[a(u,{modelValue:r(o).usernameZh,"onUpdate:modelValue":t[1]||(t[1]=e=>r(o).usernameZh=e)},null,8,["modelValue"])]),_:1}),r(M)?Q("",!0):(y(),S(_,{key:0,label:"\u5BC6\u7801",prop:"password"},{default:l(()=>[a(u,{type:"password","show-password":"",modelValue:r(o).password,"onUpdate:modelValue":t[2]||(t[2]=e=>r(o).password=e)},null,8,["modelValue"])]),_:1})),a(_,{label:"\u662F\u5426\u542F\u7528"},{tips:l(()=>[h(" \u5982\u4E0D\u542F\u7528\uFF0C\u5219\u5728\u524D\u53F0\u4E0D\u663E\u793A\uFF0C\u4E14\u4E0D\u53EF\u8BBF\u95EE. ")]),default:l(()=>[a(U,{modelValue:r(o).enabled,"onUpdate:modelValue":t[3]||(t[3]=e=>r(o).enabled=e)},null,8,["modelValue"])]),_:1}),a(_,{label:"\u89D2\u8272",prop:"role"},{default:l(()=>[a(E,{disabled:!r(F),filterable:"",modelValue:r(o).role,"onUpdate:modelValue":t[4]||(t[4]=e=>r(o).role=e),placeholder:"\u8BF7\u9009\u62E9\u5B58\u50A8\u7B56\u7565"},{default:l(()=>[(y(!0),W(X,null,Y(r(c),e=>(y(),S(Z,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["disabled","modelValue"])]),_:1}),a(_,{label:"\u5907\u6CE8"},{tips:l(()=>[h(" \u5907\u6CE8\u4FE1\u606F, \u7528\u4E8E\u8F85\u52A9\u8BF4\u660E ")]),default:l(()=>[a(u,{type:"textarea",rows:3,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",modelValue:r(o).remark,"onUpdate:modelValue":t[5]||(t[5]=e=>r(o).remark=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])}}};typeof N=="function"&&N(q);var Ce=te(q,[["__scopeId","data-v-a72ebc3a"]]);export{Ce as default};
