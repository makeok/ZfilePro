import{d as E,s as q,a as B,b as I,l as O,c as P}from"./admin-storage.576b99eb.js";import{S as T}from"./sortable.esm.d7ef5fdd.js";import{u as A}from"./useCommon.373cb8ed.js";import{r as n,c as D}from"./index.a81894c3.js";import{u as _}from"./storage-copy.b5f50f89.js";import{E as l}from"./index.9f034646.js";import{E as o}from"./request.88c6336a.js";const{isMobile:F}=A();let C=n(!1),S=n(),i=n(!1),s=n([]),r=n("");const{openDialog:K}=_();function N(t){const v=()=>{t.push("/admin/storage-edit")},u=e=>{t.push("/admin/storage-edit/"+e.id)},g=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{a==="confirm"&&E(e.id).then(c=>{o.success("\u5220\u9664\u6210\u529F"),w()})}})},k=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5173\u95ED\uFF1F\u5173\u95ED\u540E\u586B\u5199\u7684\u6570\u636E\u4E0D\u4F1A\u4FDD\u7559\u3002",{type:"warning"}).then(a=>{e()}).catch(a=>{})},d=e=>{t.push("/admin/storage-filter/"+e.id)},h=e=>{t.push("/admin/storage-readme/"+e.id)},f=e=>{t.push("/admin/storage-password/"+e.id)},m=e=>{t.push("/admin/storage-auth/"+e.id)},p=e=>{l.confirm(`\u662F\u5426\u786E\u8BA4${e.enable?"\u505C\u6B62":"\u542F\u7528"}\u5B58\u50A8\u6E90\u3002`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{if(a==="confirm"){let c=e.enable?"disable":"enable";q(e.id,c).then(()=>{o.success((e.enable?"\u505C\u6B62":"\u542F\u7528")+"\u6210\u529F"),e.enable=!e.enable})}}})},x=e=>{let a=e.enableCache?"enable":"disable";B(e.id,a).then(()=>{o.success("\u4FEE\u6539\u6210\u529F")})},y=e=>{let a=e.autoRefreshCache?"start":"stop";I(e.id,a).then(()=>{o.success("\u4FEE\u6539\u6210\u529F")})},b=e=>{S.value=e.id,C.value=!0},L=e=>{switch(e.operator){case"edit":u(e.storage);break;case"enable":p(e.storage);break;case"readmeManager":h(e.storage);break;case"cacheManager":b(e.storage);break;case"filterManager":d(e.storage);break;case"pwdManager":f(e.storage);break;case"authManager":m(e.storage);break;case"delete":g(e.storage);break;case"copy":K(e.storage);break}},R=()=>{const e=document.querySelector(".storage-container");T.create(e,{draggable:".storage-item",filter:".add-storage-btn",delay:F.value?300:0,onEnd:a=>{if(a.oldIndex===a.newIndex)return;const c=s.value.splice(a.oldIndex,1)[0];s.value.splice(a.newIndex,0,c),P(s.value).then(()=>{o.success("\u8C03\u6574\u6392\u5E8F\u6210\u529F")})}})},w=()=>{i.value=!0,O().then(e=>{s.value=e.data,R(),i.value=!1})},M=D(()=>r.value===""?s.value:s.value.filter(e=>!!(e.name&&e.name.toLowerCase().indexOf(r.value.toLowerCase())!==-1||e.remark&&e.remark.toLowerCase().indexOf(r.value.toLowerCase())!==-1||e.type&&e.type.description.toLowerCase().indexOf(r.value.toLowerCase())!==-1||e.type&&e.type.key.toLowerCase().indexOf(r.value.toLowerCase())!==-1)));return{init:w,loading:i,searchKey:r,storageListSearchResult:M,handleOperator:L,addStorage:v,editStorage:u,deleteStorage:g,handleClose:k,showFilterPage:d,showReadmePage:h,showPasswordPage:f,switchEnableStatus:p,cacheManageVisible:C,currentCacheManageId:S,switchCacheEnableStatus:x,switchCacheAutoRefreshStatus:y,cacheManage:b}}export{N as u};
